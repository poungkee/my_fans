# ğŸ‰ FANS AWS EKS êµ¬ì¶• ì™„ë£Œ - ìµœì¢… ìš”ì•½

## âœ… ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### ğŸ“ Terraform (ì¸í”„ë¼ ì½”ë“œ)
```
infra/terraform/
â”œâ”€â”€ terraform-minimal.tfvars    # ìµœì €ë¹„ìš© ì„¤ì •
â”œâ”€â”€ variables-minimal.tf        # ë³€ìˆ˜ ì •ì˜
â”œâ”€â”€ eks-spot.tf                 # Spot Instance ë…¸ë“œê·¸ë£¹
â”œâ”€â”€ rds-minimal.tf              # RDS PostgreSQL
â”œâ”€â”€ karpenter.tf                # ìë™ ìŠ¤ì¼€ì¼ë§
â”œâ”€â”€ ecr-minimal.tf              # Docker ë ˆì§€ìŠ¤íŠ¸ë¦¬
â””â”€â”€ user-data.sh                # ë…¸ë“œ ë¶€íŒ… ìŠ¤í¬ë¦½íŠ¸
```

### ğŸ“ Kubernetes (ë°°í¬ ì„¤ì •)
```
infra/kubernetes/minimal/
â”œâ”€â”€ 00-namespace.yaml           # Namespace
â”œâ”€â”€ 01-configmap.yaml           # í™˜ê²½ë³€ìˆ˜
â”œâ”€â”€ 02-secrets.yaml             # ë¹„ë°€ì •ë³´
â”œâ”€â”€ 03-redis-statefulset.yaml  # Redis (ElastiCache ëŒ€ì²´)
â”œâ”€â”€ 04-main-api.yaml            # Main API + HPA
â”œâ”€â”€ 05-frontend.yaml            # Frontend + HPA
â”œâ”€â”€ 06-ai-services.yaml         # AI ì„œë¹„ìŠ¤ 3ê°œ
â”œâ”€â”€ 07-crawler-scheduler.yaml  # í¬ë¡¤ëŸ¬ + ìŠ¤ì¼€ì¤„ëŸ¬
â”œâ”€â”€ 08-ingress.yaml             # ë„ë©”ì¸ ë¼ìš°íŒ… + SSL
â””â”€â”€ 09-karpenter-provisioner.yaml  # ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •
```

### ğŸ“ ëª¨ë‹ˆí„°ë§ (ë¬´ë£Œ)
```
infra/kubernetes/monitoring/
â”œâ”€â”€ prometheus-values.yaml      # Prometheus + Grafana
â””â”€â”€ loki-values.yaml            # ë¡œê·¸ ìˆ˜ì§‘ (CloudWatch ëŒ€ì²´)
```

### ğŸ“ CI/CD (GitHub Actions)
```
.github/workflows/
â”œâ”€â”€ deploy-backend.yml          # ë°±ì—”ë“œ ìë™ ë°°í¬
â”œâ”€â”€ deploy-frontend.yml         # í”„ë¡ íŠ¸ì—”ë“œ ìë™ ë°°í¬
â””â”€â”€ deploy-ai-services.yml      # AI ì„œë¹„ìŠ¤ ìë™ ë°°í¬
```

### ğŸ“ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```
scripts/
â””â”€â”€ deploy-all.sh               # ì „ì²´ ìë™ ë°°í¬
```

### ğŸ“ ë¬¸ì„œ
```
DEPLOYMENT_GUIDE_MINIMAL.md     # ìƒì„¸ ë°°í¬ ê°€ì´ë“œ
SETUP_SUMMARY.md                # ì´ íŒŒì¼
```

---

## ğŸ’° ë¹„ìš© êµ¬ì„± (ì›” $137)

| í•­ëª© | ì‚¬ì–‘ | ì›” ë¹„ìš© |
|------|------|--------|
| **EKS í´ëŸ¬ìŠ¤í„°** | ê´€ë¦¬í˜• K8s | $73 |
| **EC2 Spot 2ëŒ€** | t3.medium | $18 |
| **RDS Single-AZ** | db.t4g.micro, 20GB | $15 |
| **NLB** | Network LB | $16 |
| **CloudWatch** | ê¸°ë³¸ ë¡œê·¸ (7ì¼) | $5 |
| **ë°ì´í„° ì „ì†¡** | íŠ¸ë˜í”½ | $10 |
| **ì´í•©** | | **$137** |

### ë¬´ë£Œ í•­ëª©
- âœ… Redis (Podë¡œ ì‹¤í–‰)
- âœ… Prometheus + Grafana (ë¬´ë£Œ)
- âœ… Loki (ë¬´ë£Œ ë¡œê·¸ ìˆ˜ì§‘)
- âœ… ACM ì¸ì¦ì„œ (ë¬´ë£Œ SSL)
- âœ… GitHub Actions (ì›” 2000ë¶„ ë¬´ë£Œ)
- âœ… Karpenter (ë¬´ë£Œ)

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### 1. ìë™ ìŠ¤ì¼€ì¼ë§ (Karpenter)
- **Pod ì¦ê°€** â†’ 30ì´ˆ ë‚´ ìë™ìœ¼ë¡œ ë…¸ë“œ ì¶”ê°€
- **ìµœì €ê°€ Spot ì¸ìŠ¤í„´ìŠ¤** ìë™ ì„ íƒ
- **ì‚¬ìš©ë¥  ë‚®ìŒ** â†’ ë…¸ë“œ ìë™ ì¶•ì†Œ

### 2. ê³ ê°€ìš©ì„±
- **Spot Instance 2ëŒ€** (1ëŒ€ ì¤‘ë‹¨ë¼ë„ ì„œë¹„ìŠ¤ ìœ ì§€)
- **Pod Anti-Affinity** (ì—¬ëŸ¬ ë…¸ë“œì— ë¶„ì‚°)
- **HPA** (CPU/ë©”ëª¨ë¦¬ ê¸°ë°˜ ìë™ í™•ì¥)

### 3. CI/CD
- **GitHub Push** â†’ ìë™ ë¹Œë“œ/ë°°í¬
- **ë¡¤ë§ ì—…ë°ì´íŠ¸** (ë¬´ì¤‘ë‹¨ ë°°í¬)
- **Slack ì•Œë¦¼** (ë°°í¬ ì„±ê³µ/ì‹¤íŒ¨)

### 4. ëª¨ë‹ˆí„°ë§
- **Prometheus** (ë©”íŠ¸ë¦­ ìˆ˜ì§‘)
- **Grafana** (ì‹œê°í™”)
- **Loki** (ë¡œê·¸ ìˆ˜ì§‘)
- **Alertmanager** (ì•Œë¦¼)

### 5. ë³´ì•ˆ
- **HTTPS** (Let's Encrypt ë¬´ë£Œ SSL)
- **Secrets ê´€ë¦¬** (Kubernetes Secrets)
- **Security Groups** (ë°©í™”ë²½)
- **IAM Roles** (ìµœì†Œ ê¶Œí•œ)

---

## ğŸš€ ë°°í¬ ë°©ë²•

### ë¹ ë¥¸ ì‹œì‘ (ìë™)

```bash
# 1. í´ë¡ 
git clone https://github.com/your-repo/fans.git
cd fans

# 2. ì „ì²´ ìë™ ë°°í¬
bash scripts/deploy-all.sh
```

### ìˆ˜ë™ ë°°í¬

```bash
# 1. Terraform
cd infra/terraform
terraform init
terraform apply -var-file="terraform-minimal.tfvars"

# 2. Kubernetes
kubectl apply -f infra/kubernetes/minimal/

# 3. ëª¨ë‹ˆí„°ë§
helm install monitoring prometheus-community/kube-prometheus-stack \
  -n monitoring --create-namespace \
  -f infra/kubernetes/monitoring/prometheus-values.yaml
```

**ì†Œìš” ì‹œê°„**: ì•½ 60ë¶„

---

## ğŸŒ ì ‘ì† URL

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|--------|-----|------|
| **Frontend** | https://fans.ai.kr | React ì•± |
| **API** | https://api.fans.ai.kr | REST API |
| **AI Services** | https://ai.fans.ai.kr | AI ìš”ì•½/ë¶„ì„ |
| **Grafana** | https://grafana.fans.ai.kr | ëª¨ë‹ˆí„°ë§ |

---

## ğŸ“Š ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Route 53 (fans.ai.kr)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NLB (Network Load Balancer) - $16/ì›”                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NGINX Ingress Controller                               â”‚
â”‚  - fans.ai.kr â†’ Frontend                               â”‚
â”‚  - api.fans.ai.kr â†’ Main API                           â”‚
â”‚  - ai.fans.ai.kr â†’ AI Services                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EKS Cluster ($73/ì›”)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Spot Instance 1 (t3.medium) - $9/ì›”           â”‚  â”‚
â”‚  â”‚  - Frontend Pod (2 replicas)                    â”‚  â”‚
â”‚  â”‚  - Main API Pod (2 replicas)                    â”‚  â”‚
â”‚  â”‚  - Crawler Pod                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Spot Instance 2 (t3.medium) - $9/ì›”           â”‚  â”‚
â”‚  â”‚  - AI Services (3 pods)                         â”‚  â”‚
â”‚  â”‚  - Scheduler Pod                                 â”‚  â”‚
â”‚  â”‚  - Redis Pod                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  Karpenter (ìë™ ìŠ¤ì¼€ì¼ë§)                             â”‚
â”‚  - ë¶€í•˜ ì¦ê°€ ì‹œ ë…¸ë“œ ìë™ ì¶”ê°€                         â”‚
â”‚  - ìµœì €ê°€ Spot Instance ì„ íƒ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RDS PostgreSQL ($15/ì›”)                                â”‚
â”‚  - db.t4g.micro                                         â”‚
â”‚  - 20GB gp3 SSD                                         â”‚
â”‚  - Single-AZ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Monitoring (ë¬´ë£Œ)                                      â”‚
â”‚  - Prometheus (ë©”íŠ¸ë¦­)                                  â”‚
â”‚  - Grafana (ì‹œê°í™”)                                     â”‚
â”‚  - Loki (ë¡œê·¸)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ìµœì í™” í¬ì¸íŠ¸

### 1. Spot Instance (70% í• ì¸)
```yaml
capacity_type: SPOT
instance_types:
  - t3.medium
  - t3a.medium
  - t2.medium
```

### 2. Single-AZ RDS (50% ì ˆê°)
```hcl
db_multi_az = false
db_instance_class = "db.t4g.micro"  # ARM í”„ë¡œì„¸ì„œ
```

### 3. NLB vs ALB ($4 ì ˆê°)
```
NLB: $16/ì›”
ALB: $20/ì›”
```

### 4. ElastiCache ëŒ€ì‹  Redis Pod ($50 ì ˆê°)
```yaml
StatefulSet + EBS 5GB = $0/ì›”
ElastiCache t3.micro = $50/ì›”
```

### 5. CloudWatch Logs ìµœì†Œí™” ($10 ì ˆê°)
```yaml
retention: 7d  # ëŒ€ì‹  Loki ì‚¬ìš© (ë¬´ë£Œ)
```

---

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

### ë°°ìš´ ê¸°ìˆ 
1. **Terraform** - Infrastructure as Code
2. **Kubernetes** - ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
3. **Karpenter** - ìë™ ìŠ¤ì¼€ì¼ë§
4. **Spot Instances** - ë¹„ìš© ìµœì í™”
5. **Helm** - K8s íŒ¨í‚¤ì§€ ê´€ë¦¬
6. **Prometheus/Grafana** - ëª¨ë‹ˆí„°ë§
7. **GitHub Actions** - CI/CD
8. **cert-manager** - SSL ìë™í™”

### AWS ì„œë¹„ìŠ¤
- EKS (Elastic Kubernetes Service)
- RDS (Relational Database Service)
- ECR (Elastic Container Registry)
- NLB (Network Load Balancer)
- Route 53 (DNS)
- ACM (Certificate Manager)

---

## ğŸ“ˆ ë‹¤ìŒ ë‹¨ê³„

### ë‹¨ê¸° (1-2ì£¼)
- [ ] í”„ë¡œë•ì…˜ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] ë¶€í•˜ í…ŒìŠ¤íŠ¸
- [ ] ë°±ì—… ì „ëµ ìˆ˜ë¦½
- [ ] ì¥ì•  ëŒ€ì‘ ë§¤ë‰´ì–¼ ì‘ì„±

### ì¤‘ê¸° (1-3ê°œì›”)
- [ ] Reserved Instance ì „í™˜ (40% ì¶”ê°€ ì ˆê°)
- [ ] Multi-AZë¡œ ì—…ê·¸ë ˆì´ë“œ (ê³ ê°€ìš©ì„±)
- [ ] CDN ì¶”ê°€ (CloudFront)
- [ ] WAF ì„¤ì • (ë³´ì•ˆ)

### ì¥ê¸° (3-6ê°œì›”)
- [ ] Spot Fleet ìµœì í™”
- [ ] Database Read Replica
- [ ] ElastiCache ì¶”ê°€ (ì„±ëŠ¥ í–¥ìƒ)
- [ ] Multi-Region ë°°í¬

---

## ğŸ†˜ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ë¹ ë¥¸ ì°¸ì¡°

```bash
# Pod ìƒíƒœ í™•ì¸
kubectl get pods -n fans

# ë¡œê·¸ í™•ì¸
kubectl logs -f deployment/main-api -n fans

# ì´ë²¤íŠ¸ í™•ì¸
kubectl get events -n fans --sort-by='.lastTimestamp'

# ë…¸ë“œ í™•ì¸
kubectl get nodes

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
kubectl top pods -n fans
kubectl top nodes

# RDS ì—°ê²° í…ŒìŠ¤íŠ¸
kubectl run -it --rm debug --image=postgres:15 --restart=Never -n fans -- \
  psql -h YOUR_RDS_ENDPOINT -U fans_admin -d fans_db

# Grafana ì ‘ì†
kubectl port-forward svc/monitoring-grafana 3000:80 -n monitoring
```

---

## ğŸ“ ì§€ì›

- **ë¬¸ì„œ**: `DEPLOYMENT_GUIDE_MINIMAL.md`
- **GitHub Issues**: í”„ë¡œì íŠ¸ ì €ì¥ì†Œ
- **Slack**: #devops ì±„ë„

---

## ğŸ‰ ì„±ê³µ!

ì¶•í•˜í•©ë‹ˆë‹¤! ìµœì € ë¹„ìš©ìœ¼ë¡œ í”„ë¡œë•ì…˜ê¸‰ EKS í™˜ê²½ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

**ì´ ë¹„ìš©**: ì›” $137
**ì ˆê° ë¹„ìš©**: ê¸°ì¡´ ëŒ€ë¹„ 70% ì ˆê°
**ë°°í¬ ì‹œê°„**: 60ë¶„

---

**ì‘ì„±ì¼**: 2025-01-15
**ì‘ì„±ì**: Claude AI Assistant
**ë²„ì „**: 1.0
