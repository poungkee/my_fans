# í¬ë¡¤ë§ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ë° Active-Active í´ëŸ¬ìŠ¤í„° êµ¬ì¶• ê³„íš

## 1. ê°œìš”

í˜„ì¬ ë°±ì—”ë“œ API ì„œë²„ì— í†µí•©ë˜ì–´ ìˆëŠ” í¬ë¡¤ë§ ì„œë¹„ìŠ¤ë¥¼ ë…ë¦½ì ì¸ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬í•˜ê³ , Active-Active êµ¬ì¡°ì˜ ì´ì¤‘í™”ëœ í¬ë¡¤ëŸ¬ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì¶•í•˜ì—¬ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

---

## 2. í˜„ì¬ ìƒí™© ë¶„ì„

### 2.1 ê¸°ì¡´ êµ¬ì¡°
```
Backend API Server (Port 3000)
â”œâ”€â”€ News Crawler Service (í†µí•©)
â”‚   â”œâ”€â”€ Naver API í¬ë¡¤ëŸ¬ (ê²€ìƒ‰ ì¿¼ë¦¬ ê¸°ë°˜)
â”‚   â””â”€â”€ RSS í¬ë¡¤ëŸ¬ (5ê°œ ì–¸ë¡ ì‚¬ ì§ì ‘ ìˆ˜ì§‘)
â”œâ”€â”€ Auth Service
â”œâ”€â”€ News Feed Service
â”œâ”€â”€ Market Summary Service
â””â”€â”€ AI Integration Service
```

### 2.2 í˜„ì¬ í¬ë¡¤ë§ ë°©ì‹

**Naver API í¬ë¡¤ëŸ¬**:
- ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ í†µí•œ ë‰´ìŠ¤ ìˆ˜ì§‘
- ë‹¤ì–‘í•œ ì–¸ë¡ ì‚¬ì˜ ìµœì‹  ë‰´ìŠ¤ íšë“ ì‹œë„
- í•„í„°ë§ í›„ ì‹¤ì œ ì €ì¥ë¥ : **16.7%**

**RSS í”¼ë“œ í¬ë¡¤ëŸ¬**:
- ì£¼ìš” 5ê°œ ì–¸ë¡ ì‚¬ ì§ì ‘ ìˆ˜ì§‘
  - ì¡°ì„ ì¼ë³´ (SPA ì²˜ë¦¬)
  - ë§¤ì¼ê²½ì œ (SPA ì²˜ë¦¬)
  - ë¨¸ë‹ˆíˆ¬ë°ì´
  - í•œê²¨ë ˆ
  - í•œêµ­ê²½ì œ
- ê° ì–¸ë¡ ì‚¬ë³„ ìµœì‹  10ê°œ ê¸°ì‚¬ ìˆ˜ì§‘

### 2.3 í•µì‹¬ ë¬¸ì œì 

1. **ë°ì´í„° í’ˆì§ˆ ë¬¸ì œ**
   - Naver API: ì›í•˜ëŠ” ì–¸ë¡ ì‚¬ í•„í„°ë§ ë¶ˆê°€
   - ì§€ì—­/ì†Œê·œëª¨ ì–¸ë¡ ì‚¬ ìœ„ì£¼ ê²°ê³¼
   - ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ì‚¬ ë¶€ì¡±

2. **ì‹œìŠ¤í…œ êµ¬ì¡° ë¬¸ì œ**
   - API/RSS í¬ë¡¤ëŸ¬ê°€ ë‹¨ì¼ ìŠ¤ë ˆë“œë¡œ ìˆœì°¨ ì²˜ë¦¬
   - í¬ë¡¤ë§ ë¬¸ì œ ì‹œ ë©”ì¸ API ì„œë²„ì— ì˜í–¥
   - ë‹¨ì¼ ì¥ì• ì ìœ¼ë¡œ ì „ì²´ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ìœ„í—˜

---

## 3. ëª©í‘œ ì•„í‚¤í…ì²˜: API/RSS Active-Active 2x2 í´ëŸ¬ìŠ¤í„°

### 3.1 ìƒˆë¡œìš´ ì‹œìŠ¤í…œ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FANS ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend (Port 3001)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Backend API Server (Port 3000)                             â”‚
â”‚  â”œâ”€â”€ Auth Service                                           â”‚
â”‚  â”œâ”€â”€ News Feed Service                                      â”‚
â”‚  â”œâ”€â”€ Market Summary Service                                 â”‚
â”‚  â””â”€â”€ AI Integration Service                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Crawler Service Cluster (API/RSS Active-Active 2x2)        â”‚
â”‚  â”œâ”€â”€ Group A (Naver API í¬ë¡¤ëŸ¬)                             â”‚
â”‚  â”‚   â”œâ”€â”€ API Crawler A1 (Port 4001) - Primary              â”‚
â”‚  â”‚   â””â”€â”€ API Crawler A2 (Port 4003) - Secondary            â”‚
â”‚  â””â”€â”€ Group B (RSS í”¼ë“œ í¬ë¡¤ëŸ¬)                              â”‚
â”‚      â”œâ”€â”€ RSS Crawler B1 (Port 4002) - Primary              â”‚
â”‚      â””â”€â”€ RSS Crawler B2 (Port 4004) - Secondary            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI Service (Port 8002)                                     â”‚
â”‚  â””â”€â”€ Bias Analysis (í¸í–¥ì„± ë¶„ì„)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL Database (Port 5432)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 í¬ë¡¤ëŸ¬ ê·¸ë£¹ë³„ ì„¤ì •

#### Group A: Naver API í¬ë¡¤ëŸ¬
```javascript
const API_CRAWLER_CONFIG = {
  type: 'NAVER_API',
  searchQuery: 'ìµœì‹  ë‰´ìŠ¤',
  interval: 30000,      // 30ì´ˆ
  maxResults: 100,      // API ìµœëŒ€ ê²°ê³¼
  filterEnabled: true   // í’ˆì§ˆ í•„í„°ë§
};
```

#### Group B: RSS í”¼ë“œ í¬ë¡¤ëŸ¬
```javascript
const RSS_CRAWLER_CONFIG = {
  type: 'RSS_FEED',
  sources: [
    { name: 'ì¡°ì„ ì¼ë³´', url: 'https://www.chosun.com/arc/outboundfeeds/rss/', type: 'SPA' },
    { name: 'ë§¤ì¼ê²½ì œ', url: 'https://www.mk.co.kr/rss/30000001/', type: 'SPA' },
    { name: 'ë¨¸ë‹ˆíˆ¬ë°ì´', url: 'https://rss.mt.co.kr/mt_news.xml', type: 'NORMAL' },
    { name: 'í•œê²¨ë ˆ', url: 'https://www.hani.co.kr/rss/', type: 'NORMAL' },
    { name: 'í•œêµ­ê²½ì œ', url: 'https://www.hankyung.com/feed/all-news', type: 'NORMAL' }
  ],
  interval: 30000,           // 30ì´ˆ
  articlesPerSource: 10      // ì–¸ë¡ ì‚¬ë‹¹ 10ê°œ
};
```

### 3.3 ì‹œê°„ì°¨ í¬ë¡¤ë§ ì „ëµ
```
ì‹œê°„ì¶•: 0ì´ˆ   15ì´ˆ   30ì´ˆ   45ì´ˆ   60ì´ˆ   75ì´ˆ   90ì´ˆ
A1:     â—            â—            â—            â—
A2:           â—            â—            â—
B1:     â—            â—            â—            â—
B2:           â—            â—            â—
```

---

## 4. êµ¬í˜„ ê³„íš

### 4.1 Phase 1: í¬ë¡¤ëŸ¬ ì„œë¹„ìŠ¤ ë¶„ë¦¬ (1-2ì¼)
- [x] `backend/crawler-service` ë””ë ‰í† ë¦¬ ìƒì„±
- [x] API/RSS í¬ë¡¤ëŸ¬ ë¶„ë¦¬ êµ¬í˜„
- [x] í™˜ê²½ë³€ìˆ˜ ê¸°ë°˜ ì„¤ì •
- [ ] Docker ì»¨í…Œì´ë„ˆí™”

### 4.2 Phase 2: Active-Active í´ëŸ¬ìŠ¤í„° (2-3ì¼)
- [ ] 4ê°œ í¬ë¡¤ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±
- [ ] Primary/Secondary ì—­í•  ì„¤ì •
- [ ] ì‹œê°„ì°¨ ìŠ¤ì¼€ì¤„ë§ êµ¬í˜„
- [ ] ì¤‘ë³µ ë°©ì§€ ë¡œì§

### 4.3 Phase 3: ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ (1-2ì¼)
- [ ] í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
- [ ] í¬ë¡¤ë§ í†µê³„ ëŒ€ì‹œë³´ë“œ
- [ ] ì¥ì•  ì•Œë¦¼ ì‹œìŠ¤í…œ

---

## 5. Docker Compose ì„¤ì •

```yaml
version: '3.8'

services:
  # Group A: Naver API Crawlers
  api-crawler-a1:
    build: ./backend/crawler-service
    container_name: fans_api_crawler_a1
    ports:
      - "4001:4001"
    environment:
      - CRAWLER_TYPE=API
      - CRAWLER_ROLE=PRIMARY
      - NAVER_CLIENT_ID=${NAVER_CLIENT_ID}
      - NAVER_CLIENT_SECRET=${NAVER_CLIENT_SECRET}
      - SEARCH_QUERY=ìµœì‹  ë‰´ìŠ¤
      - CRAWLER_DELAY=0
      - DB_HOST=postgres
      - PORT=4001
    depends_on:
      - postgres
    restart: unless-stopped

  api-crawler-a2:
    build: ./backend/crawler-service
    container_name: fans_api_crawler_a2
    ports:
      - "4003:4003"
    environment:
      - CRAWLER_TYPE=API
      - CRAWLER_ROLE=SECONDARY
      - NAVER_CLIENT_ID=${NAVER_CLIENT_ID}
      - NAVER_CLIENT_SECRET=${NAVER_CLIENT_SECRET}
      - SEARCH_QUERY=ìµœì‹  ë‰´ìŠ¤
      - CRAWLER_DELAY=15000
      - DB_HOST=postgres
      - PORT=4003
    depends_on:
      - postgres
    restart: unless-stopped

  # Group B: RSS Feed Crawlers
  rss-crawler-b1:
    build: ./backend/crawler-service
    container_name: fans_rss_crawler_b1
    ports:
      - "4002:4002"
    environment:
      - CRAWLER_TYPE=RSS
      - CRAWLER_ROLE=PRIMARY
      - RSS_FEEDS=chosun,mk,mt,hani,hankyung
      - CRAWLER_DELAY=0
      - DB_HOST=postgres
      - PORT=4002
    depends_on:
      - postgres
    restart: unless-stopped

  rss-crawler-b2:
    build: ./backend/crawler-service
    container_name: fans_rss_crawler_b2
    ports:
      - "4004:4004"
    environment:
      - CRAWLER_TYPE=RSS
      - CRAWLER_ROLE=SECONDARY
      - RSS_FEEDS=chosun,mk,mt,hani,hankyung
      - CRAWLER_DELAY=15000
      - DB_HOST=postgres
      - PORT=4004
    depends_on:
      - postgres
    restart: unless-stopped
```

---

## 6. API ì—”ë“œí¬ì¸íŠ¸

### 6.1 í¬ë¡¤ëŸ¬ ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸
```
GET  /health                    # í—¬ìŠ¤ì²´í¬
GET  /crawler/status            # í¬ë¡¤ë§ ìƒíƒœ
GET  /crawler/stats             # í¬ë¡¤ë§ í†µê³„
POST /crawler/start             # í¬ë¡¤ë§ ì‹œì‘
POST /crawler/stop              # í¬ë¡¤ë§ ì¤‘ì§€
```

### 6.2 ë©”ì¸ API í”„ë¡ì‹œ ì—”ë“œí¬ì¸íŠ¸
```
GET  /api/crawler/cluster/status   # ì „ì²´ í´ëŸ¬ìŠ¤í„° ìƒíƒœ
GET  /api/crawler/cluster/stats    # í†µí•© í†µê³„
POST /api/crawler/cluster/control  # í´ëŸ¬ìŠ¤í„° ì œì–´
```

---

## 7. ëª¨ë‹ˆí„°ë§ ë° ê´€ë¦¬

### 7.1 í´ëŸ¬ìŠ¤í„° ìƒíƒœ ëª¨ë‹ˆí„°ë§
```json
{
  "cluster_status": "healthy",
  "groups": {
    "A": {
      "type": "NAVER_API",
      "primary": { "id": "A1", "status": "active", "last_crawl": "2025-09-29T15:30:00Z" },
      "secondary": { "id": "A2", "status": "active", "last_crawl": "2025-09-29T15:30:15Z" }
    },
    "B": {
      "type": "RSS_FEED",
      "primary": { "id": "B1", "status": "active", "last_crawl": "2025-09-29T15:30:00Z" },
      "secondary": { "id": "B2", "status": "active", "last_crawl": "2025-09-29T15:30:15Z" }
    }
  },
  "statistics": {
    "total_articles_today": 847,
    "api_success_rate": "16.7%",
    "rss_success_rate": "92.3%",
    "avg_crawl_time": "1.8s"
  }
}
```

### 7.2 ì•Œë¦¼ ì‹œìŠ¤í…œ
- í¬ë¡¤ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ë‹¤ìš´ ì•Œë¦¼
- API ì„±ê³µë¥  15% ë¯¸ë§Œ ì‹œ ì•Œë¦¼
- RSS í”¼ë“œ ì˜¤ë¥˜ ë°œìƒ ì•Œë¦¼
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨ ì•Œë¦¼

---

## 8. ì„±ëŠ¥ ê°œì„  íš¨ê³¼

### 8.1 ì˜ˆìƒ íš¨ê³¼
| í•­ëª© | ê¸°ì¡´ | ê°œì„  í›„ | í–¥ìƒë¥  |
|------|------|---------|--------|
| ì²˜ë¦¬ ì†ë„ | 8ë¶„ | 2ë¶„ | 75% â†‘ |
| ê°€ìš©ì„± | 95% | 99.75% | 5% â†‘ |
| ë°ì´í„° ìˆ˜ì§‘ëŸ‰ | 8ê°œ/ë¶„ | 50ê°œ/ë¶„ | 525% â†‘ |
| ì‹¤ì‹œê°„ì„± | 30ì´ˆ | 15ì´ˆ | 2ë°° â†‘ |

### 8.2 ì¥ì•  ëŒ€ì‘
- **Primary ì¥ì• **: Secondary ìë™ ìŠ¹ê²©
- **Group ì¥ì• **: ë‹¤ë¥¸ Group ë…ë¦½ ìš´ì˜
- **ì™„ì „ ë³µêµ¬**: 15ì´ˆ ì´ë‚´

---

## 9. ê°œë°œ ì§„í–‰ í˜„í™© (2025-09-29)

### 9.1 ì™„ë£Œëœ ì‘ì—… âœ…
- RSS í¬ë¡¤ëŸ¬ êµ¬í˜„ ë° ì•ˆì •í™”
- SPA ì‚¬ì´íŠ¸ ì²˜ë¦¬ (ì¡°ì„ ì¼ë³´, ë§¤ì¼ê²½ì œ)
- ì¸ì½”ë”© ê¹¨ì§ ê°ì§€ ë° í•„í„°ë§
- AI í¸í–¥ì„± ë¶„ì„ ì„œë¹„ìŠ¤ í†µí•©
- ë¬¸ë‹¨ êµ¬ë¶„ ê°œì„ 

### 9.2 ì§„í–‰ì¤‘ ğŸ”„
- í¬ë¡¤ëŸ¬ ì„œë¹„ìŠ¤ ë…ë¦½ ë¶„ë¦¬
- Docker ì»¨í…Œì´ë„ˆí™”

### 9.3 ì˜ˆì • ğŸ“‹
- Active-Active í´ëŸ¬ìŠ¤í„° êµ¬ì¶•
- ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
- ìë™ í˜ì¼ì˜¤ë²„

---

## 10. ì£¼ìš” ì˜ì‚¬ê²°ì • ê¸°ë¡

### 10.1 ì¹´í…Œê³ ë¦¬ ê¸°ë°˜ â†’ API/RSS ê¸°ë°˜ ì „í™˜ (2025-09-24)

**ë¬¸ì œì **:
- Naver APIë¡œ íŠ¹ì • ì–¸ë¡ ì‚¬ í•„í„°ë§ ë¶ˆê°€
- ì¹´í…Œê³ ë¦¬ë³„ í¬ë¡¤ë§ ì‹œ ë°ì´í„° ì ˆëŒ€ëŸ‰ ë¶€ì¡±
- í•„í„°ë§ í›„ 16.7%ë§Œ ì €ì¥ ê°€ëŠ¥

**í•´ê²°ì±…**:
- Naver API: ë‹¤ì–‘ì„± í™•ë³´ìš© ë³´ì¡° ìˆ˜ë‹¨
- RSS í”¼ë“œ: ì£¼ìš” ì–¸ë¡ ì‚¬ ì§ì ‘ ìˆ˜ì§‘ìœ¼ë¡œ í’ˆì§ˆ í™•ë³´
- ì´ì¤‘í™” êµ¬ì¡°ë¡œ ì•ˆì •ì„± í™•ë³´

### 10.2 SPA ì²˜ë¦¬ ë°©ì‹ ê²°ì • (2025-09-27)

**ë¬¸ì œì **:
- ì¡°ì„ ì¼ë³´, ë§¤ì¼ê²½ì œ ë“± SPA êµ¬ì¡°ë¡œ ì½˜í…ì¸  ì¶”ì¶œ ë¶ˆê°€

**í•´ê²°ì±…**:
- RSS description í•„ë“œ í™œìš©
- Puppeteer ë„ì…ì€ ë¹„ìš© ë¬¸ì œë¡œ ë³´ë¥˜ (ì›” $30-60 ì¶”ê°€)

---

**ë¬¸ì„œ ë²„ì „**: v3.0
**ìµœì¢… ìˆ˜ì •**: 2025-09-29
**ë‹¤ìŒ ê²€í† **: 2025-10-06