# 🏗️ FANS AWS 마이그레이션 아키텍처

## 📊 **전체 시스템 아키텍처**

```
                            ┌─────────────────┐
                            │   CloudFront    │
                            │  (CDN + HTTPS)  │
                            └──────┬──────────┘
                                   │
                    ┌──────────────┴──────────────┐
                    │                             │
            ┌───────▼────────┐         ┌──────────▼─────────┐
            │      S3        │         │   Application      │
            │  (Frontend)    │         │  Load Balancer     │
            │   Static Web   │         │     (ALB)          │
            └────────────────┘         └──────────┬─────────┘
                                                  │
                              ┌───────────────────┼───────────────────┐
                              │                   │                   │
                    ┌─────────▼───────────────────▼───────────────────▼─────────┐
                    │                 ECS Fargate Cluster                      │
                    │                                                          │
                    │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
                    │  │  Main API   │  │ RSS Crawler │  │ API Crawler │     │
                    │  │  (Port:3000)│  │ (Port:4002) │  │ (Port:4003) │     │
                    │  └─────────────┘  └─────────────┘  └─────────────┘     │
                    │                                                          │
                    │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
                    │  │Summarize AI │  │Recommend AI │  │Bias-Anal AI │     │
                    │  │ (Port:8000) │  │ (Port:8001) │  │ (Port:8002) │     │
                    │  └─────────────┘  └─────────────┘  └─────────────┘     │
                    └──────────────────────┬───────────────────────────────────┘
                                           │
                    ┌──────────────────────┼───────────────────────────────────┐
                    │                      │                                   │
            ┌───────▼────────┐    ┌────────▼────────┐       ┌──────────▼──────────┐
            │  ElastiCache   │    │   RDS PostgreSQL │       │    CloudWatch       │
            │   (Redis)      │    │   Multi-AZ      │       │   Logs & Metrics    │
            │   Session/Cache│    │   Backup        │       │     Monitoring      │
            └────────────────┘    └─────────────────┘       └─────────────────────┘
```

## 🌐 **네트워크 구성도**

```
┌─────────────────────────────────────────────────────────────────────┐
│                          VPC (10.0.0.0/16)                         │
│                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │                    Public Subnets                          │   │
│   │                                                             │   │
│   │  ┌─────────────┐      ┌─────────────┐    ┌─────────────┐   │   │
│   │  │     ALB     │      │   NAT GW    │    │   Bastion   │   │   │
│   │  │ AZ-1 (1a)   │      │  AZ-1 (1a)  │    │ Host (1a)   │   │   │
│   │  └─────────────┘      └─────────────┘    └─────────────┘   │   │
│   │                                                             │   │
│   │  ┌─────────────┐      ┌─────────────┐                      │   │
│   │  │     ALB     │      │   NAT GW    │                      │   │
│   │  │ AZ-2 (1c)   │      │  AZ-2 (1c)  │                      │   │
│   │  └─────────────┘      └─────────────┘                      │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │                   Private Subnets                          │   │
│   │                                                             │   │
│   │  ┌─────────────┐      ┌─────────────┐    ┌─────────────┐   │   │
│   │  │  ECS Tasks  │      │    RDS      │    │ ElastiCache │   │   │
│   │  │  AZ-1 (1a)  │      │ Primary(1a) │    │   AZ-1 (1a) │   │   │
│   │  └─────────────┘      └─────────────┘    └─────────────┘   │   │
│   │                                                             │   │
│   │  ┌─────────────┐      ┌─────────────┐    ┌─────────────┐   │   │
│   │  │  ECS Tasks  │      │    RDS      │    │ ElastiCache │   │   │
│   │  │  AZ-2 (1c)  │      │Standby (1c) │    │   AZ-2 (1c) │   │   │
│   │  └─────────────┘      └─────────────┘    └─────────────┘   │   │
│   └─────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
```

## 🔄 **서비스 배포 전략**

```
GitHub Repository
        │
        ▼
┌─────────────────┐
│   GitHub        │ ──── Push to main branch
│   Actions       │
└─────┬───────────┘
      │ CI/CD Pipeline
      ▼
┌─────────────────┐
│  Docker Build   │ ──── Build & Push to ECR
│  & ECR Push     │
└─────┬───────────┘
      │
      ▼
┌─────────────────┐
│  ECS Service    │ ──── Rolling Update
│  Update         │      (Zero Downtime)
└─────────────────┘
```

## 📈 **오토 스케일링 구성**

```
                    ┌─────────────────┐
                    │  CloudWatch     │
                    │  Metrics        │
                    │  • CPU > 70%    │
                    │  • Memory > 80% │
                    │  • Request/sec  │
                    └────────┬────────┘
                             │ Trigger
                             ▼
    ┌─────────────────────────────────────────────────────┐
    │              Auto Scaling                           │
    │                                                     │
    │  Current: 2 Tasks    ┌───┐ ┌───┐                    │
    │                      │ T │ │ T │                    │
    │                      └───┘ └───┘                    │
    │                                                     │
    │  Scale Out: 6 Tasks  ┌───┐ ┌───┐ ┌───┐ ┌───┐      │
    │                      │ T │ │ T │ │ T │ │ T │      │
    │                      └───┘ └───┘ └───┘ └───┘      │
    │                      ┌───┐ ┌───┐                    │
    │                      │ T │ │ T │                    │
    │                      └───┘ └───┘                    │
    └─────────────────────────────────────────────────────┘
```

## 💰 **비용 구성 분석**

```
┌─────────────────────────────────────────────────────┐
│                월 예상 비용                           │
├─────────────────────────────────────────────────────┤
│  💻 ECS Fargate (6 서비스)           $120-160       │
│  🗄️  RDS PostgreSQL (Multi-AZ)       $35-45        │
│  ⚡ ElastiCache (Redis)              $25-35         │
│  🌐 CloudFront + S3                 $10-15         │
│  🔗 ALB + NAT Gateway               $15-25         │
│  📊 CloudWatch                      $5-10          │
├─────────────────────────────────────────────────────┤
│  💡 총 예상 비용                    $210-290/월      │
│                                                     │
│  🎯 Spot Instance 적용 시           $160-220/월      │
│     (약 25-30% 절약)                                │
└─────────────────────────────────────────────────────┘
```

## 🚀 **마이그레이션 단계별 계획**

### Phase 1: 기반 인프라 (1주차)
```
1. VPC, Subnets, Security Groups 설정
2. RDS PostgreSQL 구축 및 데이터 마이그레이션
3. ElastiCache Redis 클러스터 구축
4. ECR Repository 생성
```

### Phase 2: 컨테이너화 (2주차)
```
1. Docker 이미지 최적화 및 ECR 푸시
2. ECS Cluster 및 Task Definition 작성
3. 로드 밸런서 및 타겟 그룹 설정
4. Auto Scaling 정책 구성
```

### Phase 3: CI/CD 구축 (3주차)
```
1. GitHub Actions 워크플로우 작성
2. 배포 자동화 파이프라인 구축
3. 모니터링 및 알람 설정
4. 보안 그룹 및 IAM 역할 최적화
```

### Phase 4: 프론트엔드 및 최적화 (4주차)
```
1. S3 + CloudFront 프론트엔드 배포
2. 성능 테스트 및 튜닝
3. 보안 검토 및 강화
4. 백업 및 재해 복구 절차 수립
```

## 🔒 **보안 고려사항**

```
┌─────────────────────────────────────────────────────┐
│                 보안 레이어                          │
├─────────────────────────────────────────────────────┤
│  🌐 CloudFront     │ WAF + DDoS Protection         │
│  🔒 ALB            │ SSL/TLS Termination           │
│  🏰 Security Groups │ Port-level Access Control    │
│  🗄️  RDS            │ Encryption at Rest/Transit   │
│  🔐 ElastiCache    │ Auth Token + Encryption       │
│  👤 IAM            │ Least Privilege Principle     │
│  📱 Secrets Manager │ API Keys & DB Credentials    │
└─────────────────────────────────────────────────────┘
```

## 📞 **연락처 및 참고사항**

- **아키텍처 문의**: 팀 리드와 상의 후 결정
- **예산 승인**: $200-300/월 예산 검토 필요
- **마이그레이션 일정**: 총 4주 소요 예상
- **다운타임**: Rolling 배포로 무중단 마이그레이션 가능

---

*📅 작성일: 2025-09-24*
*✅ 검토 상태: 팀 검토 대기 중*